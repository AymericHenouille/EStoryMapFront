"use strict";(self.webpackChunkEStoryMapFront=self.webpackChunkEStoryMapFront||[]).push([[538],{538:(z,g,c)=>{c.r(g),c.d(g,{ProjectModule:()=>H});var a=c(60),m=c(4521),d=c(4004),j=c(9300),h=c(3900),t=c(5e3),l=c(1188),C=c(9760),Z=c(4594),_=c(7423),T=c(3874);const P=function(n){return["/workspaces",n]};function O(n,r){if(1&n&&(t.TgZ(0,"button",2),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_back"),t.qZA(),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("routerLink",t.VKq(1,P,e.workspace.id))}}function U(n,r){if(1&n&&(t.TgZ(0,"mat-toolbar"),t.YNc(1,O,3,3,"button",1),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.workspace),t.xp6(2),t.AsE("",e.project.emoticon," ",e.project.label,"")}}let M=(()=>{class n{constructor(e){this.projectService=e}ngOnInit(){this._workspace=this.projectService.getProjectWorkspace(this.project).subscribe(e=>this.workspace=e)}ngOnDestroy(){this._workspace.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-header"]],inputs:{project:"project"},decls:1,vars:1,consts:[[4,"ngIf"],["mat-icon-button","",3,"routerLink",4,"ngIf"],["mat-icon-button","",3,"routerLink"]],template:function(e,o){1&e&&t.YNc(0,U,4,3,"mat-toolbar",0),2&e&&t.Q6J("ngIf",o.project)},directives:[a.O5,Z.Ye,_.lW,m.rH,T.Hw],styles:[""]}),n})();var v=c(3954),b=c(1271),A=c(520);let S=(()=>{class n{constructor(e){this.projectService=e,this.projectUpdate=new t.vpe}uploadFile(e){var o;const i=e.target;i.files&&i.files.length>0&&(null===(o=this._upload)||void 0===o||o.unsubscribe(),this._upload=this.projectService.uploadFile(this.project,this.type,i.files[0]).pipe((0,j.h)(p=>p.type===A.dt.Response),(0,d.U)(p=>p)).subscribe(p=>this.projectUpdate.emit(p.body)))}ngOnDestroy(){var e;null===(e=this._upload)||void 0===e||e.unsubscribe(),this.projectUpdate.complete()}get accept(){switch(this.type){case"bpmn":return".bpmn";case"mcd":return".xml";case"mfc":return".drawio.xml"}}get fileFieldName(){var e;return null!==(e=this.project[this.type.toLowerCase()+"Name"])&&void 0!==e?e:"Aucun fichier"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-item"]],inputs:{type:"type",project:"project"},outputs:{projectUpdate:"projectUpdate"},decls:11,vars:5,consts:[[1,"item"],[1,"first-line"],[1,"type"],[3,"click"],[1,"file-name","full-witdh","text-center"],["type","file",1,"file-input",3,"accept","change"],["fileUpload",""]],template:function(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"span",2),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return t.CHM(i),t.MAs(10).click()}),t._uU(6," import "),t.qZA(),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"input",5,6),t.NdJ("change",function(s){return o.uploadFile(s)}),t.qZA()}2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,3,o.type)),t.xp6(5),t.Oqu(o.fileFieldName),t.xp6(1),t.Q6J("accept",o.accept))},pipes:[a.gd],styles:[".item[_ngcontent-%COMP%]{margin-top:2em}.item[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:2em}.file-input[_ngcontent-%COMP%]{display:none}.first-line[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.text-center[_ngcontent-%COMP%]{text-align:center}.full-width[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]{width:100%}.file-name[_ngcontent-%COMP%]{margin-top:2em;font-size:1.1em;font-style:italic}"]}),n})();var y=c(4834);let w=(()=>{class n{constructor(e,o){this.snackBar=e,this.projectService=o}updateNotify(e){this.snackBar.open(`Projet ${e.label} mis \xe0 jour`,"Ok",{duration:2e3}),this.projectService.updateRequest()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.ux),t.Y36(l.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import-side"]],inputs:{project:"project"},decls:5,vars:3,consts:[["type","bpmn",1,"full-width",3,"project","projectUpdate"],["type","mcd",1,"full-width",3,"project","projectUpdate"],["type","mfc",1,"full-width",3,"project","projectUpdate"]],template:function(e,o){1&e&&(t.TgZ(0,"app-item",0),t.NdJ("projectUpdate",function(p){return o.updateNotify(p)}),t.qZA(),t._UZ(1,"mat-divider"),t.TgZ(2,"app-item",1),t.NdJ("projectUpdate",function(p){return o.updateNotify(p)}),t.qZA(),t._UZ(3,"mat-divider"),t.TgZ(4,"app-item",2),t.NdJ("projectUpdate",function(p){return o.updateNotify(p)}),t.qZA()),2&e&&(t.Q6J("project",o.project),t.xp6(2),t.Q6J("project",o.project),t.xp6(2),t.Q6J("project",o.project))},directives:[S,y.d],styles:[".full-witdh[_ngcontent-%COMP%]{width:100%}mat-divider[_ngcontent-%COMP%]{margin-top:.5em;margin-bottom:.5em}"]}),n})();var u=c(9224),I=c(5899);function x(n,r){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.ekj("clean",100===(null==o.analyse?null:o.analyse.percent)),t.xp6(1),t.hij(" ",e," ")}}const J=function(){return[]};let F=(()=>{class n{constructor(e){this.projectService=e}ngOnChanges(e){var o;const i=e.project.currentValue;i&&(null===(o=this._analyse)||void 0===o||o.unsubscribe(),this.projectService.analyse(i).subscribe(p=>this.analyse=p))}ngOnDestroy(){var e;null===(e=this._analyse)||void 0===e||e.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-report-side"]],inputs:{project:"project"},features:[t.TTD],decls:13,vars:11,consts:[[1,"container"],[3,"clean",4,"ngFor","ngForOf"],["mode","buffer","color","accent",3,"value","bufferValue"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"mat-card"),t.TgZ(2,"mat-card-title"),t._uU(3," Structure de "),t.TgZ(4,"span"),t._uU(5),t.qZA(),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"mat-card-content"),t.TgZ(9,"ul"),t.YNc(10,x,2,3,"li",1),t.qZA(),t.qZA(),t.TgZ(11,"mat-card-footer"),t._UZ(12,"mat-progress-bar",2),t.qZA(),t.qZA(),t.qZA()),2&e){let i,p,s,f;t.xp6(4),t.Udp("color",o.project.color),t.xp6(1),t.Oqu(o.project.label),t.xp6(1),t.hij(" valide a ",t.xi3(7,7,null!==(i=null==o.analyse?null:o.analyse.percent)&&void 0!==i?i:0,"2.2-2"),"% "),t.xp6(4),t.Q6J("ngForOf",null!==(p=null==o.analyse?null:o.analyse.messages)&&void 0!==p?p:t.DdM(10,J)),t.xp6(2),t.Q6J("value",null!==(s=null==o.analyse?null:o.analyse.percent)&&void 0!==s?s:0)("bufferValue",null!==(f=null==o.analyse?null:o.analyse.percent)&&void 0!==f?f:0)}},directives:[u.a8,u.n5,u.dn,a.sg,u.rt,I.pW],pipes:[a.JJ],styles:['@import"https://fonts.googleapis.com/css?family=Ubuntu";.container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}.container[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}.container[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{font-family:Ubuntu,sans-serif;font-size:17px;color:#e74c3c}.container[_ngcontent-%COMP%]   .clean[_ngcontent-%COMP%]{color:#2ecc71}']}),n})();function Y(n,r){if(1&n&&t._UZ(0,"app-header",4),2&n){const e=t.oxw();t.Q6J("project",e.project)}}function N(n,r){if(1&n&&(t.TgZ(0,"mat-grid-list",5),t.TgZ(1,"mat-grid-tile"),t._UZ(2,"app-import-side",6),t.qZA(),t._UZ(3,"mat-divider",7),t.TgZ(4,"mat-grid-tile"),t._UZ(5,"app-report-side",6),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("project",e.project),t.xp6(3),t.Q6J("project",e.project)}}const Q=[{path:":id",component:(()=>{class n{constructor(e,o){this.activatedRoute=e,this.projectService=o}ngOnInit(){this._project=this.activatedRoute.paramMap.pipe((0,d.U)(e=>e.get("id")),(0,j.h)(e=>!!e),(0,h.w)(e=>this.projectService.getProjectById(null!=e?e:"")),(0,h.w)(e=>this.projectService.getProjectWorkspace(e).pipe((0,d.U)(o=>({project:e,workspace:o}))))).subscribe(({project:e,workspace:o})=>{this.project=e,console.log(this.workspace=o)})}ngOnDestroy(){this._project.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(l.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project"]],decls:4,vars:4,consts:[[3,"project",4,"ngIf"],["class","project-page","cols","2",4,"ngIf"],[1,"down-right"],["mode","edit",3,"workspace","project"],[3,"project"],["cols","2",1,"project-page"],[1,"full-width",3,"project"],["vertical","true"]],template:function(e,o){1&e&&(t.YNc(0,Y,1,1,"app-header",0),t.YNc(1,N,6,2,"mat-grid-list",1),t.TgZ(2,"div",2),t._UZ(3,"app-add-project",3),t.qZA()),2&e&&(t.Q6J("ngIf",o.project),t.xp6(1),t.Q6J("ngIf",o.project),t.xp6(2),t.Q6J("workspace",o.workspace)("project",o.project))},directives:[a.O5,C.S,M,v.Il,v.DX,w,y.d,F],styles:[".full-width[_ngcontent-%COMP%]{width:100%}mat-grid-list[_ngcontent-%COMP%]     .mat-grid-tile-content{max-height:70vh}.down-right[_ngcontent-%COMP%]{position:absolute;right:1em;bottom:1em}.down-right[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:.5em}"]}),n})()}];let R=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Q)],m.Bz]}),n})();var q=c(9098),k=c(7354);let H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[a.ez,R,q.m,k.W]]}),n})()}}]);